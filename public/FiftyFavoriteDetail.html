<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
    <!-- <form method="GET">
        <label for="Age"></label>
        <input type="text" name="Age">
    </form> -->
    <title>피프티하우스</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <!--<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"> -->
    <link rel="stylesheet" type="text/css" href="css/lightpick.css">
    <!-- <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"> -->

    <style>
        /* @font-face {
			font-family: 'KoPub';
			src: url(font\KoPubWorld Dotum Bold.ttf);
		} */

        body {
            font-family: KoPub
        }

        .box {
            width: 25%;
            height: 100px;
            display: inline-block;
            border: 3px solid gray;
        }

        #blue-box {
            background: white;
            border-radius: 15px;
        }

        .float-frame {
            background: #eee;
            border: 1px solid #ddd;
            overflow: hidden;
        }

        .float-unit {
            border: 1px;
            width: 16.6%;
            height: auto;
            background: #eee;
            color: #333;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            padding-left: 5px;
            float: left;
        }
        /*datepicer 버튼 롤오버 시 손가락 모양 표시*/

        .ui-datepicker-trigger {
            cursor: pointer;
        }
        /*datepicer input 롤오버 시 손가락 모양 표시*/

        .hasDatepicker {
            cursor: pointer;
        }
    </style>

</head>

<body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Main -->
        <div id="main">
            <div class="inner_over">
                <header id="header">

                    <a href="FiftyFavorite.html" class="logo"><strong>연령대 별 관심사 목록 (detail) </strong></a>

                    <div class="lightpick__day-of-the-week">
                        <input type="text" id="start" /> ~~ <input type="text" id="end" />
                    </div>
                    <div></div>
                </header>


                <div class="limiter">

                    <div class="table100 ver2 m-b-110">
                        <div class="table100-head">
                            <table>
                                <thead>
                                    <tr class="row100 head">
                                        <th class="cell100 column1">연령대</th>
                                        <th class="cell100 column2">관심사</th>
                                        <th class="cell100 column3">인원</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>

                    <div class="table100-body js-pscroll">
                        <table id="MemberTable">
                            <tbody id="MemberData"> </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- Sidebar -->
        <div id="sidebar">
            <div class="inner">

                <!-- Search
								<section id="search" class="alt">
									<form method="post" action="#">
										<input type="text" name="query" id="query" placeholder="Search" />
									</form>
								</section>
-->
                <!-- Menu -->
                <nav id="menu">
                    <header class="major">
                        <h2>메뉴</h2>
                    </header>
                    <ul>
                        <li>
                            <a href="index.html"><i class="fas fa-home">대시보드</i></a>
                        </li>

                        <li>
                            <span class="opener"><i class="fas fa-user">활동 현황</i></span>
                            <ul>
                                <li><a href="FiftyMember.html">회원 목록</a></li>
                                <li><a href="FiftyFavorite.html">관심사 목록</a></li>
                                <li><a href="FiftyClub.html">클럽 목록</a></li>
                                <!-- <li><a href="InvalidMember.html">만료 회원</a></li>
												<li><a href="readyMember.html">코치 배정 대기 회원</a></li>
												<li><a href="registMember.html">회원 등록</a></li> -->
                            </ul>
                        </li>

                        <li>
                            <span class="opener"><i class="fas fa-university"> 알림</i></span>
                            <ul>
                                <li><a href="FiftyNotice.html">공지사항</a></li>
                                <li><a href="FiftyEvent.html">이벤트</a></li>
                                <li><a href="FiftyFAQ.html">FAQ</a></li>
                            </ul>
                        </li>

                </nav>


                <!-- Section
								<section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<p>Sed varius enim lorem ullamcorper dolore aliquam aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin sed aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="#">information@untitled.tld</a></li>
										<li class="icon solid fa-phone">(000) 000-0000</li>
										<li class="icon solid fa-home">1234 Somewhere Road #8254<br />
										Nashville, TN 00000-0000</li>
									</ul>
								</section>
								-->

                <!-- Footer -->
                <footer id="footer">
                    <p class="copyright"> Copyright@피프티하우스 CO.,LTD. All rights reserved</p>
                </footer>

            </div>
        </div>

    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>

    <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.5.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.5.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.5.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.11.0/firebase-firestore.js"></script>

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script src="./fireinit.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="js/lightpick.js"></script>

    <script>
        var db = firebase.firestore();
        var FavorSetEachAge = new Map();
        var g_MaxShowCntInAge = 5; // max show favorite count each ages
        var GetFavoriteAge_Total_QueryCnt = 0;
        //GetFavoriteAgeEachGeneration(30, 0, 0);

        GetFavoriteAgeEachGeneration(0, 30001231); // Search in 0 ~ 3000-12-31

        function Print_Favor_Age_For_Debug() {
            // print FavorSet
            for (var [key, Favorites] of FavorSetEachAge) {
                console.log('FavorSet_Key :' + key);
                for (var [f_key, f_val] of Favorites) {
                    console.log('Favors :' + f_key + " ," + f_val);
                }
            }
        }

        function GetFavoriteAgeEachGeneration(queryStdate, queryEdDate) {
            FavorSetEachAge.clear();
            var Age = parseInt(Get_GETParameter("Age"));
            var doc_FavoriteAge_Date = db.collection("Favorite_Age_Per_Date");
            doc_FavoriteAge_Date.get().then((querySnapshot) => {
                if (querySnapshot) {
                    querySnapshot.forEach(doc_ref => {
                        var doc_FavoriteAge = db.collection("Favorite_Age_Per_Date").doc(doc_ref.id).collection("Favorite_Age");
                        date = parseInt(doc_ref.id)



                        if (date >= queryStdate && date <= queryEdDate) {
                            // get data from collecton
                            doc_FavoriteAge.get().then((querySnapshot_2) => {
                                if (querySnapshot_2) {
                                    querySnapshot_2.forEach(doc => {
                                        //let AgeDocs = AgeDoc.data();
                                        // for debug
                                        // console.log('문서의 id :' + doc.id);
                                        // for (let item in docs) {
                                        //     console.log('key :' + item);
                                        //     console.log('value :' + docs[item]);
                                        // }
                                        var myYear = new Date().getYear();
                                        var key = parseInt((myYear - doc.id));
                                        var _k = parseInt(key / 10);
                                        var _a = parseInt(Age / 10);

                                        if (_k == _a) {
                                            var doc_Favorite_List = db.collection("Favorite_Age_Per_Date").doc(doc_ref.id).collection("Favorite_Age").doc(doc.id).collection("Favorite_List");
                                            GetFavoriteAge_Total_QueryCnt++;
                                            doc_Favorite_List.get().then((querySnapshot_3) => {
                                                if (querySnapshot_3) {
                                                    querySnapshot_3.forEach((doc) => {
                                                        var name = doc.id
                                                        var cnt = doc.data()["count"]
                                                            // console.log('Age :' + key);
                                                            // console.log('Favor :' + name);
                                                            // console.log('val :' + cnt);
                                                        if (FavorSetEachAge.has(key)) {
                                                            var Favorites = FavorSetEachAge.get(key);
                                                            if (Favorites.has(name)) {
                                                                var val = Favorites.get(name) + cnt;
                                                                Favorites.set(name, val);
                                                            } else {
                                                                Favorites.set(name, cnt);
                                                            }
                                                        } else {
                                                            var Favorites = new Map();
                                                            Favorites.set(name, cnt);
                                                            FavorSetEachAge.set(key, Favorites);
                                                        }
                                                    });
                                                }
                                                GetFavoriteAge_Total_QueryCnt--;
                                                if (GetFavoriteAge_Total_QueryCnt == 0) {
                                                    // sort item
                                                    for (let [key, value] of FavorSetEachAge) {
                                                        value[Symbol.iterator] = function*() {
                                                            yield*[...this.entries()].sort((a, b) => b[1] - a[1]);
                                                        }
                                                    }
                                                    WebDisplay();
                                                }
                                            });
                                        }


                                    });
                                    //Print_Favor_Age_For_Debug();
                                }
                            });
                        }


                    });
                }
            });
        }

        function TrancPage_Total_Age(age) {

        }

        function WebDisplay() {
            var MemberData = document.getElementById('MemberData');
            MemberData.innerHTML = "";
            for (var [key, Favorites] of FavorSetEachAge) {
                var cellCnt = 0;
                var cell2String = "";
                var cell3String = "";
                var MemberData = document.getElementById('MemberData');
                var row = MemberData.insertRow(MemberData.rows.length); // 하단에 추가

                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell3 = row.insertCell(2);
                cell1.setAttribute('class', 'cell100 column1');
                // cell1.addEventListener("click", function(event) {
                //     console.log(parseInt(String(event.target.innerHTML)));
                // });
                cell2.setAttribute('class', 'cell100 column2');
                cell3.setAttribute('class', 'cell100 column3');

                cell1.innerHTML = String(key).concat("세");
                for (var [f_key, f_val] of Favorites) {
                    if (cellCnt == g_MaxShowCntInAge) {
                        break;
                    }
                    var el_key = document.createElement('div');
                    var el_val = document.createElement('div');
                    el_key.type = 'text'
                    el_key.innerHTML = String(f_key);
                    cell2.appendChild(el_key);
                    el_val.type = 'text'
                    el_val.innerHTML = String(f_val);
                    cell3.appendChild(el_val);

                    cellCnt++;
                }
            }
        }

        function Get_GETParameter(name) {
            var rtnval = '';
            var nowAddress = unescape(location.href);
            var parameters = (nowAddress.slice(nowAddress.indexOf('?') + 1,
                nowAddress.length)).split('&');
            for (var i = 0; i < parameters.length; i++) {
                var varName = parameters[i].split('=')[0];
                if (varName.toUpperCase() == name.toUpperCase()) {
                    rtnval = parameters[i].split('=')[1];
                    break;
                }
            }
            return rtnval;
        }
    </script>
    <!-- <script>
        var Request = function() {
            this.getParameter = function(name) {
                var rtnval = '';
                var nowAddress = unescape(location.href);
                var parameters = (nowAddress.slice(nowAddress.indexOf('?') + 1,
                    nowAddress.length)).split('&');
                for (var i = 0; i < parameters.length; i++) {
                    var varName = parameters[i].split('=')[0];
                    if (varName.toUpperCase() == name.toUpperCase()) {
                        rtnval = parameters[i].split('=')[1];
                        break;
                    }
                }
                return rtnval;
            }
        }
        var request = new Request(); -->
    </script>
    <!-- <script>
        // $(function() {
        //     //모든 datepicker에 대한 공통 옵션 설정
        //     $.datepicker.setDefaults({
        //         dateFormat: 'yy-mm-dd' //Input Display Format 변경
        //             ,
        //         showOtherMonths: true //빈 공간에 현재월의 앞뒤월의 날짜를 표시
        //             ,
        //         showMonthAfterYear: true //년도 먼저 나오고, 뒤에 월 표시
        //             ,
        //         changeYear: true //콤보박스에서 년 선택 가능
        //             ,
        //         changeMonth: true //콤보박스에서 월 선택 가능
        //             ,
        //         showOn: "both" //button:버튼을 표시하고,버튼을 눌러야만 달력 표시 ^ both:버튼을 표시하고,버튼을 누르거나 input을 클릭하면 달력 표시
        //             ,
        //         buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif" //버튼 이미지 경로
        //             ,
        //         buttonImageOnly: true //기본 버튼의 회색 부분을 없애고, 이미지만 보이게 함
        //             ,
        //         buttonText: "선택" //버튼에 마우스 갖다 댔을 때 표시되는 텍스트
        //             ,
        //         yearSuffix: "년" //달력의 년도 부분 뒤에 붙는 텍스트
        //             ,
        //         monthNamesShort: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'] //달력의 월 부분 텍스트
        //             ,
        //         monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'] //달력의 월 부분 Tooltip 텍스트
        //             ,
        //         dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'] //달력의 요일 부분 텍스트
        //             ,
        //         dayNames: ['일요일', '월요일', '화요일', '수요일', '목요일', '금요일', '토요일'] //달력의 요일 부분 Tooltip 텍스트
        //             ,
        //         minDate: "-1M" //최소 선택일자(-1D:하루전, -1M:한달전, -1Y:일년전)
        //             ,
        //         maxDate: "+1M" //최대 선택일자(+1D:하루후, -1M:한달후, -1Y:일년후)
        //     });

        //     //input을 datepicker로 선언
        //     $("#datepicker").datepicker();
        //     $("#datepicker2").datepicker();

        //     //From의 초기값을 오늘 날짜로 설정
        //     $('#datepicker').datepicker('setDate', 'today'); //(-1D:하루전, -1M:한달전, -1Y:일년전), (+1D:하루후, -1M:한달후, -1Y:일년후)
        //     //To의 초기값을 내일로 설정
        //     $('#datepicker2').datepicker('setDate', '+1D'); //(-1D:하루전, -1M:한달전, -1Y:일년전), (+1D:하루후, -1M:한달후, -1Y:일년후)
        // });
    </script> -->
    <script>
        var picker = new Lightpick({
            //field: document.getElementById('datepicker')
            field: document.getElementById('start'),
            secondField: document.getElementById('end'),
            // onSelect: function(start, end) {
            //     GetFavoriteAgeEachGeneration(start, end);
            // }
            onSelect: function(start, end) {
                if (!start || !end) {
                    return false;
                }
                var stDate = parseInt(start.format('YYYYMMDD'));
                var edDate = parseInt(end.format('YYYYMMDD'));
                var MemberData = document.getElementById('MemberData');
                MemberData.innerHTML = "";
                GetFavoriteAgeEachGeneration(stDate, edDate);
            }
        });
    </script>

</body>

</html>
<!-- Banner -->
<!--
	<section id="banner">
		<div class="content">
			<header>
				<h1>Hi, I’m Editorial<br />
				by HTML5 UP</h1>
				<p>A free and fully responsive site template</p>
			</header>
			<p>Aenean ornare velit lacus, ac varius enim ullamcorper eu. Proin aliquam facilisis ante interdum congue. Integer mollis, nisl amet convallis, porttitor magna ullamcorper, amet egestas mauris. Ut magna finibus nisi nec lacinia. Nam maximus erat id euismod egestas. Pellentesque sapien ac quam. Lorem ipsum dolor sit nullam.</p>
			<ul class="actions">
				<li><a href="#" class="button big">Learn More</a></li>
			</ul>
		</div>
		<span class="image object">
			<img src="images/pic10.jpg" alt="" />
		</span>
	</section>
-->
<!-- Section -->
<!--
	<section>
		<header class="major">
			<h2>Erat lacinia</h2>
		</header>
		<div class="features">
			<article>
				<span class="icon fa-gem"></span>
				<div class="content">
					<h3>Portitor ullamcorper</h3>
					<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				</div>
			</article>
			<article>
				<span class="icon solid fa-paper-plane"></span>
				<div class="content">
					<h3>Sapien veroeros</h3>
					<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				</div>
			</article>
			<article>
				<span class="icon solid fa-rocket"></span>
				<div class="content">
					<h3>Quam lorem ipsum</h3>
					<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				</div>
			</article>
			<article>
				<span class="icon solid fa-signal"></span>
				<div class="content">
					<h3>Sed magna finibus</h3>
					<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				</div>
			</article>
		</div>
	</section>
-->
<!-- Section -->
<!--
	<section>
		<header class="major">
			<h2>Ipsum sed dolor</h2>
		</header>
		<div class="posts">
			<article>
				<a href="#" class="image"><img src="images/pic01.jpg" alt="" /></a>
				<h3>Interdum aenean</h3>
				<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				<ul class="actions">
					<li><a href="#" class="button">More</a></li>
				</ul>
			</article>
			<article>
				<a href="#" class="image"><img src="images/pic02.jpg" alt="" /></a>
				<h3>Nulla amet dolore</h3>
				<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				<ul class="actions">
					<li><a href="#" class="button">More</a></li>
				</ul>
			</article>
			<article>
				<a href="#" class="image"><img src="images/pic03.jpg" alt="" /></a>
				<h3>Tempus ullamcorper</h3>
				<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				<ul class="actions">
					<li><a href="#" class="button">More</a></li>
				</ul>
			</article>
			<article>
				<a href="#" class="image"><img src="images/pic04.jpg" alt="" /></a>
				<h3>Sed etiam facilis</h3>
				<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				<ul class="actions">
					<li><a href="#" class="button">More</a></li>
				</ul>
			</article>
			<article>
				<a href="#" class="image"><img src="images/pic05.jpg" alt="" /></a>
				<h3>Feugiat lorem aenean</h3>
				<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				<ul class="actions">
					<li><a href="#" class="button">More</a></li>
				</ul>
			</article>
			<article>
				<a href="#" class="image"><img src="images/pic06.jpg" alt="" /></a>
				<h3>Amet varius aliquam</h3>
				<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>
				<ul class="actions">
					<li><a href="#" class="button">More</a></li>
				</ul>
			</article>
		</div>
	</section>
-->
